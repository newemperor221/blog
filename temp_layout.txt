---
import NavBar from '../components/navbar/NavBar.svelte'
import Brand from '../components/Brand.svelte'
import Sidebar from '../components/sidebar/Sidebar.svelte'
import HeaderCover from '../components/HeaderCover.svelte'
import Footer from '../components/footer/Footer.astro'
import Widgets from '../components/footer/Widgets.svelte'
import { getCollection } from 'astro:content'

import themeConfig from '../theme.config.ts'

import '@/styles/palette.css'
import '@/styles/style.css'
import '@/styles/header-cover.css'
import '@/components/footer/footer.css'
import '@/components/footer/widgets.css'

const navLinks = themeConfig.nav
const siteName = themeConfig.siteName
const sidebarConfig = themeConfig.sidebar || {}
const brandConfig = themeConfig.brand || {}
const coverConfig = themeConfig.cover || {}
const footerConfig = themeConfig.footer || {}
const widgetsConfig = themeConfig.widgets || {}

// Get all posts for widgets
const allPosts = await getCollection('posts')
const posts = allPosts.filter((post) => !post.data.draft)
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <title>Astro Basics</title>
  </head>
  <body>
    <HeaderCover
      client:load
      enableCover={coverConfig.enableCover}
      enablePreload={coverConfig.enablePreload}
      fixedCover={coverConfig.fixedCover}
      gradient={coverConfig.gradient}
      covers={coverConfig.covers}
      title={brandConfig.title}
    />
    <NavBar client:load name={siteName} navLinks={navLinks} clickToggleCallback={() => void 0} />
    <Brand client:load title={brandConfig.title} subtitle={brandConfig.subtitle} logo={brandConfig.logo} />
    <main class="mt-12.5">
      <slot />
    </main>
    <Widgets
      client:load
      posts={posts}
      enableRandomPosts={widgetsConfig.randomPosts !== false}
      enableRecentComments={widgetsConfig.recentComments !== false}
    />
    <Sidebar client:load config={sidebarConfig} navLinks={navLinks} />
    <Footer
      config={footerConfig}
      siteName={siteName}
      author={sidebarConfig.author}
    />
  </body>
</html>

<style></style>

